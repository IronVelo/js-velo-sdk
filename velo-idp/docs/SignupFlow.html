<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: SignupFlow</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: SignupFlow</h1>

    




<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>SignupFlow<span class="signature">()</span><span class="type-signature"></span></h2>
        
            <div class="class-description"><p>A class that provides a high-level interface for the signup API.</p></div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    
    <h4 class="name" id="SignupFlow"><span class="type-signature"></span>new SignupFlow<span class="signature">()</span><span class="type-signature"></span></h4>
    

    















    <h5 class="subsection-title">Properties:</h5>

    

<table class="props">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>baseUrl</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                
                </td>
            

            

            <td class="description last"><p>The base URL for the signup API.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>permit</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;number></span>


            
            </td>

            
                <td class="attributes">
                

                
                    &lt;nullable><br>
                
                </td>
            

            

            <td class="description last"><p>The current permit.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>state</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                
                </td>
            

            

            <td class="description last"><p>The current state of the signup flow.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>fetch</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                

                
                </td>
            

            

            <td class="description last"><p>The fetch function to use.</p></td>
        </tr>

    
    </tbody>
</table>




<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="signup.js.html">signup.js</a>, <a href="signup.js.html#line148">line 148</a>
    </li></ul></dd>
    

    

    

    
</dl>



















    <h5>Example</h5>
    
    <pre class="prettyprint"><code>// Establish a new SignupFlow
let signup_flow = new SignupFlow("https://some-url-to-velo-idp.com");

// Say hello, requesting a username
try { await signup_flow.helloSignup("username"); } catch (e) {
    if (e instanceof UsernameExistsError) {
        console.log("Username already exists.");
    }
    return;
};

// Set the password
try {
    await signup_flow.setPassword("Password123!");
} catch (e) {
    if (e instanceof InsufficientPassword) {
        console.log(`Try a better pass, reason: ${e.variant}`);
        return;
    } else if (e instanceof PreconditionFailedError) {
        console.log("Permit expired. Start over");
        return;
    }
};

// Set our first MFA method, TOTP is always best
const qr_code = await signup_flow.setupTotp();
// display the QR code to the user, so they can scan it ...

// Verify the TOTP code
if (await signup_flow.verifyTotp("12345678")) {
    console.log("TOTP verified!");
} else {
    console.log("TOTP failed verification.");
    // user should retry, they have 5 attempts by default
    return;
}

// Setup another form of MFA, SMS OTP
await signup_flow.setupSmsOtp("5555555555");

// Verify the SMS OTP
if (await signup_flow.verifyOtp("111111")) {
    console.log("SMS OTP verified!");
} else {
    console.log("SMS OTP failed verification.");
    // user should retry, they have 5 attempts by default
    return;
}

// At any point after the first MFA method we could have issued
// a token. We can set up Email as another MFA method, but we'll
// just finalize the signup process here.
const token = await signup_flow.issueToken();

// now our signup process is complete, and we are logged in with
// the token.
console.log("Token:", token);</code></pre>



    
    </div>

    

    

    
        <h3 class="subsection-title">Classes</h3>

        <dl>
            <dt><a href="SignupFlow_SignupFlow.html">SignupFlow</a></dt>
            <dd></dd>
        </dl>
    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="helloSignup"><span class="type-signature">(async) </span>helloSignup<span class="signature">(username)</span><span class="type-signature"> &rarr; {Promise.&lt;void>}</span></h4>
    

    



<div class="description">
    <p>Start the signup process by sending the username.</p>
<h2>Transitions To:</h2>
<ul>
<li><code>Set Password</code> - If the username is available, otherwise an error is thrown.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>username</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The username to sign up with.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="signup.js.html">signup.js</a>, <a href="signup.js.html#line306">line 306</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>
<ul>
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the username already exists.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="UsernameExistsError.html">UsernameExistsError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the HTTP request fails.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="HttpError.html">HttpError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    </ul>


<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;void></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="issueToken"><span class="type-signature">(async) </span>issueToken<span class="signature">()</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;number>>}</span></h4>
    

    



<div class="description">
    <p>Issue a token for the user, finalizing the signup process.</p>
<p>If this is not ever called, the signup process so far will have 0 impact on the system, like it never happened.</p>
<h2>Transitions To:</h2>
<ul>
<li>TERMINAL - The signup process is complete.</li>
</ul>
<h2>Transitioned From:</h2>
<ul>
<li><code>Verify OTP</code> - If the OTP was valid.</li>
<li><code>Verify TOTP</code> - If the TOTP was valid.</li>
</ul>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="signup.js.html">signup.js</a>, <a href="signup.js.html#line678">line 678</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>
<ul>
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the current state is invalid for this operation (the previous state was not
an MFA verification state).</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="InvalidStateError.html">InvalidStateError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the HTTP request fails.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="HttpError.html">HttpError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the permit has expired.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="PreconditionFailedError.html">PreconditionFailedError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    </ul>


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise that resolves to the issued token.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;number>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="setPassword"><span class="type-signature">(async) </span>setPassword<span class="signature">(password)</span><span class="type-signature"> &rarr; {Promise.&lt;void>}</span></h4>
    

    



<div class="description">
    <p>Set the password for the user.</p>
<h2>Transitions To:</h2>
<ul>
<li><code>Setup TOTP</code>
| <code>Setup SMS OTP</code>
| <code>Setup Email OTP</code> - If the password is sufficiently complex.</li>
<li><code>Set Password</code> - If the password is insufficiently complex the user should
be prompted to enter a new password. See <a href="InsufficientPassword.html"><code>InsufficientPassword</code></a> for details on the requirements.</li>
</ul>
<h2>Transitioned From:</h2>
<ul>
<li><code>Hello Signup</code> - If the username is available.</li>
<li><code>Set Password</code> - If the password was insufficiently complex.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>password</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The password to set.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="signup.js.html">signup.js</a>, <a href="signup.js.html#line357">line 357</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>
<ul>
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the current state is invalid for this operation.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="InvalidStateError.html">InvalidStateError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the password is insufficiently complex.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="InsufficientPassword.html">InsufficientPassword</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the permit from <code>helloSignup</code> has expired.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="PreconditionFailedError.html">PreconditionFailedError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the HTTP request fails.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="HttpError.html">HttpError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    </ul>


<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;void></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="setupEmailOtp"><span class="type-signature"></span>setupEmailOtp<span class="signature">(email)</span><span class="type-signature"> &rarr; {Promise.&lt;void>}</span></h4>
    

    



<div class="description">
    <p>Setup Email OTP as an MFA method.</p>
<h2>Transitions To:</h2>
<ul>
<li><code>Verify OTP</code> - To verify that the Email OTP is set up correctly.</li>
</ul>
<h2>Transitioned From:</h2>
<ul>
<li><code>Set Password</code> - If the password was sufficiently complex.</li>
<li><code>Verify OTP</code> - If the OTP was valid (for setting up SMS OTP).</li>
<li><code>Verify TOTP</code> - If the TOTP was valid.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>email</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The email address to associate with the Email OTP.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="signup.js.html">signup.js</a>, <a href="signup.js.html#line593">line 593</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>
<ul>
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the current state is invalid for this operation.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="InvalidStateError.html">InvalidStateError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the permit from either <code>setPassword</code> or any verification state has expired.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="PreconditionFailedError.html">PreconditionFailedError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the HTTP request fails.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="HttpError.html">HttpError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    </ul>


<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;void></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="setupSmsOtp"><span class="type-signature"></span>setupSmsOtp<span class="signature">(phoneNumber)</span><span class="type-signature"> &rarr; {Promise.&lt;void>}</span></h4>
    

    



<div class="description">
    <p>Setup SMS OTP as an MFA method.</p>
<h2>Transitions To:</h2>
<ul>
<li><code>Verify OTP</code> - To verify that the SMS OTP is set up correctly.</li>
</ul>
<h2>Transitioned From:</h2>
<ul>
<li><code>Set Password</code> - If the password was sufficiently complex.</li>
<li><code>Verify OTP</code> - If the OTP was valid (for setting up Email OTP).</li>
<li><code>Verify TOTP</code> - If the TOTP was valid.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>phoneNumber</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The phone number to associate with the SMS OTP.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="signup.js.html">signup.js</a>, <a href="signup.js.html#line562">line 562</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>
<ul>
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the current state is invalid for this operation.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="InvalidStateError.html">InvalidStateError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the permit from either <code>setPassword</code> or any verification state has expired.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="PreconditionFailedError.html">PreconditionFailedError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the HTTP request fails.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="HttpError.html">HttpError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    </ul>


<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;void></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="setupTotp"><span class="type-signature">(async) </span>setupTotp<span class="signature">()</span><span class="type-signature"> &rarr; {Promise.&lt;string>}</span></h4>
    

    



<div class="description">
    <p>Setup TOTP as an MFA method.</p>
<h2>Transitions To:</h2>
<ul>
<li><code>Verify TOTP</code> - To verify that the users authenticator is set up correctly.</li>
</ul>
<h2>Transitioned From:</h2>
<ul>
<li><code>Set Password</code> - If the password was sufficiently complex.</li>
<li><code>Verify OTP</code> - If the OTP was valid (for setting up SMS or Email OTP).</li>
</ul>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="signup.js.html">signup.js</a>, <a href="signup.js.html#line424">line 424</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>
<ul>
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the current state is invalid for this operation.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="InvalidStateError.html">InvalidStateError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the permit from either <code>setPassword</code> or any verification state has expired.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="PreconditionFailedError.html">PreconditionFailedError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the HTTP request fails.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="HttpError.html">HttpError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    </ul>


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise that resolves to a data URL representing the QR code.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;string></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="verifyOtp"><span class="type-signature">(async) </span>verifyOtp<span class="signature">(otp)</span><span class="type-signature"> &rarr; {Promise.&lt;boolean>}</span></h4>
    

    



<div class="description">
    <p>Verify the OTP for either SMS or Email.</p>
<h2>Transitions To:</h2>
<p><code>Issue Token</code>
| <code>Setup SMS OTP</code>
| <code>Setup Email OTP</code>
| <code>Setup TOTP</code> - If the OTP is valid the user can either finalize the signup process,
This cannot transition to any setup state that it has already transitioned from.</p>
<h2>Transitioned From:</h2>
<ul>
<li><code>Setup SMS OTP</code></li>
<li><code>Setup Email OTP</code></li>
<li><code>Verify OTP</code> - If the OTP was invalid the user should be prompted to retry. They
have 5 attempts by default.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>otp</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The OTP to verify.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="signup.js.html">signup.js</a>, <a href="signup.js.html#line632">line 632</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>
<ul>
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the current state is invalid (the previous state was not <code>setupSmsOtp</code> or
<code>setupEmailOtp</code>).</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="InvalidStateError.html">InvalidStateError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the permit from <code>setupSmsOtp</code> or <code>setupEmailOtp</code> has expired or the maximum
attempts have been reached.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="PreconditionFailedError.html">PreconditionFailedError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the HTTP request fails.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="HttpError.html">HttpError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    </ul>


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise that resolves to true if the OTP is valid, false otherwise.
If the OTP is invalid, the user should be prompted to enter the code again.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;boolean></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="verifyTotp"><span class="type-signature">(async) </span>verifyTotp<span class="signature">(totp)</span><span class="type-signature"> &rarr; {Promise.&lt;boolean>}</span></h4>
    

    



<div class="description">
    <p>Verify the TOTP code.</p>
<h2>Transitions To:</h2>
<ul>
<li><code>Issue Token</code>
| <code>Setup SMS OTP</code>
| <code>Setup Email OTP</code> - If the TOTP code is valid the user can either finalize the
signup process or set up another MFA method.</li>
<li><code>Verify TOTP</code> - If the TOTP code is invalid, the user should be prompted to retry,
by default, they have 5 attempts.</li>
</ul>
<h2>Transitioned From:</h2>
<ul>
<li><code>Setup TOTP</code></li>
<li><code>Verify TOTP</code> - If the TOTP code was invalid the user should be prompted to retry.</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>totp</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The 8 digit TOTP code to verify.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="signup.js.html">signup.js</a>, <a href="signup.js.html#line492">line 492</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>
<ul>
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the current state is invalid (the previous state was not <code>setupTotp</code>).</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="InvalidStateError.html">InvalidStateError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the permit from <code>setupTotp</code> has expired or the maximum attempts have been
reached.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="PreconditionFailedError.html">PreconditionFailedError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        <p>If the HTTP request fails.</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type"><a href="HttpError.html">HttpError</a></span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    </ul>


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise that resolves to true if the TOTP code is valid, false otherwise.
If false, the user should be prompted to enter the code again.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;boolean></span>


    </dd>
</dl>

    





        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="HttpError.html">HttpError</a></li><li><a href="InsufficientPassword.html">InsufficientPassword</a></li><li><a href="InvalidStateError.html">InvalidStateError</a></li><li><a href="PreconditionFailedError.html">PreconditionFailedError</a></li><li><a href="SignupFlow.html">SignupFlow</a></li><li><a href="SignupFlow_SignupFlow.html">SignupFlow</a></li><li><a href="UsernameExistsError.html">UsernameExistsError</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Fri Apr 05 2024 21:14:36 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>